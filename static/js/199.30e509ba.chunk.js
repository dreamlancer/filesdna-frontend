(this.webpackJsonpfilesdna=this.webpackJsonpfilesdna||[]).push([[199],{1837:function(e,t,n){"use strict";n.r(t);var a=n(35),r=n.n(a),c=n(33),o=n(43),u=n(0),s=n.n(u),i=n(460),l=n(61),f=n(45),p=n(68),m=n(69);t.default=function(e){var t=Object(i.useStripe)(),n=e.oInfo,a=e.pOptions,y=void 0===a?{}:a,b=e.onSuccess,d=void 0===b?function(){}:b;function h(){return(h=Object(c.a)(r.a.mark((function e(a){var c,o,u,s,i,l,f,y,b;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.complete,o=void 0===c?function(){}:c,u=a.paymentMethod,s=void 0===u?{}:u,i="",e.prev=2,e.next=5,Object(m.a)("create/payment-intent",n,"post");case 5:if(!(l=e.sent).success||!l.client_secret){e.next=10;break}i=l.client_secret,e.next=13;break;case 10:return o("fail"),Object(p.a)("error","payment.failed"),e.abrupt("return");case 13:e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(2),o("fail"),Object(p.a)("error","payment.failed"),e.abrupt("return");case 20:return e.next=22,t.confirmCardPayment(i,{payment_method:s.id},{handleActions:!1});case 22:if(f=e.sent,y=f.paymentIntent,!f.error){e.next=29;break}o("fail"),e.next=39;break;case 29:if(o("success"),"requires_action"!==y.status){e.next=38;break}return e.next=33,t.confirmCardPayment(i);case 33:b=e.sent,b.error?Object(p.a)("error","payment.failed"):d(s),e.next=39;break;case 38:d(s);case 39:case"end":return e.stop()}}),e,null,[[2,15]])})))).apply(this,arguments)}var O=function(e){var t=e.options,n=e.onPaymentMethod,a=Object(i.useStripe)(),r=Object(u.useState)(null),c=Object(o.a)(r,2),s=c[0],l=c[1],f=Object(u.useState)(!1),m=Object(o.a)(f,2),y=m[0],b=m[1];return Object(u.useEffect)((function(){if(a&&null===s){var e=a.paymentRequest(t);l(e)}}),[a,t,s]),Object(u.useEffect)((function(){var e=!0;return s&&s.canMakePayment().then((function(t){t&&e?b(!0):Object(p.a)("error","payment.payError")})),function(){e=!1}}),[s]),Object(u.useEffect)((function(){return s&&s.on("paymentmethod",n),function(){s&&s.off("paymentmethod",n)}}),[s,n]),y?s:null}({options:y,onPaymentMethod:function(e){return h.apply(this,arguments)}}),j=function(e){return Object(u.useMemo)((function(){return{paymentRequest:e,style:{paymentRequestButton:{theme:"dark",height:"48px"}}}}),[e])}(O);return O?s.a.createElement(i.PaymentRequestButtonElement,{className:"PaymentRequestButton",options:j,onReady:function(){console.log("PaymentRequestButton [ready]")},onClick:function(e){console.log("PaymentRequestButton [click]",e)},onBlur:function(){console.log("PaymentRequestButton [blur]")},onFocus:function(){console.log("PaymentRequestButton [focus]")}}):s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,{className:"payNowBtn",type:"primary",disabled:!0},s.a.createElement(f.a,{id:"billing.payNow"})),s.a.createElement("p",{className:"errTxt"},s.a.createElement(f.a,{id:"payment.payError"})))}}}]);